# Dr.COM VPN 网络共享系统 - 项目说明

## ⚠️ 重要声明

**此软件仅供学习用途使用。**

使用此软件则代表您愿意承担所造成的法律问题，开发者不为此承担任何法律义务。

请严格遵守相关法律法规和学校网络使用规定。因使用本软件造成的任何后果由使用者自行承担。

---

## 📂 项目结构

```
drcom/
├── common/                    # 公共模块
│   ├── __init__.py           # 模块初始化（含免责声明）
│   ├── config.py             # 配置管理
│   ├── logger.py             # 日志系统
│   └── drcom_login.py        # Dr.COM登录模块
│
├── server/                    # 服务端模块
│   ├── __init__.py           # 模块初始化（含免责声明）
│   └── vpn_server.py         # VPN服务端程序
│
├── client/                    # 客户端模块（命令行版）
│   ├── __init__.py           # 模块初始化（含免责声明）
│   └── vpn_client.py         # VPN客户端程序
│
├── client_gui/                # 客户端模块（GUI版）
│   ├── __init__.py           # 模块初始化（含免责声明）
│   └── vpn_client_gui.py     # VPN客户端GUI程序
│
├── docs/                      # 文档目录
│   ├── 快速开始.md           # 5分钟快速部署指南
│   ├── 使用示例.md           # 10个实际应用场景
│   ├── 开发说明.md           # 开发者文档
│   ├── 验证逻辑分析.md       # Dr.COM认证系统分析
│   └── 项目总结.md           # 项目完成情况总结
│
├── logs/                      # 日志目录（自动创建）
│   ├── vpn_server_YYYYMMDD.log
│   ├── vpn_client_YYYYMMDD.log
│   └── drcom_login_YYYYMMDD.log
│
├── start_server.py            # 服务端启动脚本（推荐使用）
├── start_client.py            # 客户端启动脚本（命令行版）
├── start_client_gui.py        # 客户端启动脚本（GUI版）
│
├── requirements.txt           # Python依赖列表
├── .gitignore                 # Git忽略文件配置
├── README.md                  # 项目主文档
└── 项目说明.md                # 本文件
```

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 启动服务端（交互式输入）

```bash
python start_server.py
```

**首次使用时按提示输入**：
```
Dr.COM 用户名: MR646C80105795
Dr.COM 密码: ******** (隐藏输入)
确认密码: ********
服务端口 [默认: 8888]: 

是否保存配置？(y/n) [y]: y
🔐 设置主密码: ******** (用于加密配置)
✓ 配置已加密保存
```

### 3. 启动客户端

**命令行版本（交互式）**：
```bash
python start_client.py
# 按提示输入配置
```

**GUI版本**：
```bash
python start_client_gui.py
# 在界面中填写信息
```

## 📖 文档导航

- **新手入门**：阅读 [`docs/快速开始.md`](docs/快速开始.md)
- **使用教程**：查看 [`docs/使用示例.md`](docs/使用示例.md)
- **开发指南**：参考 [`docs/开发说明.md`](docs/开发说明.md)
- **完整文档**：查看 [`README.md`](README.md)

## 🔧 模块说明

### common 模块（公共组件）

- **config.py**: 统一管理所有配置参数
  - Dr.COM服务器配置
  - 重试策略配置
  - VPN参数配置
  - 日志配置

- **logger.py**: 提供详细的日志记录
  - 多级别日志（DEBUG/INFO/WARNING/ERROR）
  - 同时输出到控制台和文件
  - 自动日志轮转

- **drcom_login.py**: Dr.COM登录核心
  - 模拟网页登录
  - 自动获取内网IP
  - 网络状态检测
  - 智能重试机制

### server 模块（服务端）

- **vpn_server.py**: VPN服务器实现
  - 自动登录并获取网络权限
  - 接受客户端连接
  - 重新登录抢回网络
  - 提供VPN转发服务
  - 心跳保活

### client 模块（客户端 - 命令行版）

- **vpn_client.py**: 命令行客户端
  - 自动登录踢掉服务端
  - 连接到服务端内网
  - 报告客户端IP
  - 建立VPN连接
  - 跨平台支持

### client_gui 模块（客户端 - GUI版）

- **vpn_client_gui.py**: 图形界面客户端
  - 基于Flet框架
  - 现代化UI设计
  - 实时日志显示
  - 多平台支持（Windows/Linux/macOS/移动端）

## ⚙️ 配置说明

编辑 `common/config.py` 文件可以自定义配置：

```python
# Dr.COM服务器地址
DRCOM_CONFIG = {
    'base_url': 'http://10.252.252.5',
    'eportal_port': 801,
    # ...
}

# 重试策略
RETRY_CONFIG = {
    'max_retries': 5,       # 最大重试次数
    'retry_delay': 15,      # 重试间隔（秒）
    # ...
}

# VPN配置
VPN_CONFIG = {
    'server_port': 8888,    # 服务端口
    'heartbeat_interval': 15,  # 心跳间隔
    # ...
}
```

## 📝 日志文件

所有日志保存在 `logs/` 目录：

- `vpn_server_YYYYMMDD.log` - 服务端日志
- `vpn_client_YYYYMMDD.log` - 客户端日志  
- `drcom_login_YYYYMMDD.log` - 登录模块日志
- `vpn_client_gui_YYYYMMDD.log` - GUI客户端日志

日志文件自动轮转，单个文件最大10MB，保留最近5个文件。

## 🔍 故障排查

1. **查看日志文件** - `logs/` 目录下的对应日志
2. **检查网络连通性** - `ping <服务器IP>`
3. **测试端口开放** - `telnet <服务器IP> 8888`
4. **阅读文档** - `docs/` 目录下的相关文档
5. **查看README** - 故障排查部分

## 💡 使用技巧

### 开机自启动

**Linux systemd**:
```bash
sudo systemctl enable drcom-vpn-server
sudo systemctl start drcom-vpn-server
```

**Windows任务计划程序**:
创建计划任务，执行 `python start_server.py ...`

### 后台运行

**Linux/macOS**:
```bash
nohup python start_server.py username password 8888 &
```

**Windows**:
```bash
pythonw start_server.py username password 8888
```

### Docker部署

```bash
docker build -t drcom-vpn-server .
docker run -d --name vpn-server --network host drcom-vpn-server
```

## 🛡️ 安全建议

- ⚠️ 不要在公共场合明文输入密码
- ⚠️ 定期更换密码
- ⚠️ 不要将配置文件上传到公共仓库
- ⚠️ 仅在信任的内网环境使用
- ⚠️ 遵守学校网络使用规定

## 📞 获取帮助

1. **文档**: 查阅 `docs/` 目录下的详细文档
2. **README**: 阅读主文档的相关章节
3. **日志**: 查看详细的日志输出
4. **Issues**: 提交问题反馈（如果有GitHub仓库）

## 🎯 适用场景

- 宿舍多设备共享网络
- 实验室设备网络接入
- 开发板/树莓派联网
- OpenWrt路由器作为客户端
- 移动设备通过VPN上网

## 📄 许可与声明

- 本项目基于 MIT 许可证
- **仅供学习和研究使用**
- 使用者需遵守相关法律法规
- 开发者不承担任何法律责任

---

**版本**: v1.0.0  
**最后更新**: 2025-11-06  
**开发语言**: Python 3.7+

