# 项目转型说明

## 📋 概述

本项目已从 **"VPN网络共享系统"** 转型为 **"校园网自动认证工具"**。

### 转型时间
2025-11-10

### 版本变更
- **v1.x**: VPN共享系统（已废弃）
- **v2.0.0+**: 自动认证工具（当前版本）

---

## 🔄 转型原因

### 1. 技术可行性验证

经过全面的网络环境测试，包括：
- Nmap端口扫描
- TCP数据传输测试  
- 协议伪装验证
- AC（访问控制器）策略分析

### 2. 发现的问题

**VPN方案不可行的原因**：
- ❌ AC严格拦截未认证设备的流量
- ❌ VPN端口（8888）被完全拦截（DROP）
- ❌ 标准端口（80）被劫持到认证页面
- ❌ 协议伪装无效（AC在网络层拦截，与应用层协议无关）
- ❌ 只有白名单IP（认证服务器）可访问，但需要攻击学校服务器（违法）

### 3. 发现的价值

虽然VPN方案不可行，但测试过程中发现：
- ✅ **认证模块完全可用**
- ✅ 可以自动获取网络参数
- ✅ 可以自动发送认证请求
- ✅ 可以查询在线状态和主动下线
- ✅ 对无图形界面设备很有价值

---

## 🎯 新的定位

### 项目目标

为无图形界面的设备提供**命令行自动认证**功能，解决：
- Linux服务器无法通过浏览器认证
- OpenWrt路由器需要自动联网
- 树莓派/NAS等嵌入式设备开机联网
- Docker容器网络认证

### 核心功能

1. **自动认证**
   ```bash
   python drcom_auth.py -u 学号 -p 密码
   ```

2. **状态查询**
   ```bash
   python drcom_auth.py --status
   ```

3. **主动下线**
   ```bash
   python drcom_auth.py --logout
   ```

4. **自动重连**
   ```bash
   python drcom_auth.py --auto-reconnect
   ```

### 适用场景

| 场景 | 说明 | 优势 |
|------|------|------|
| Linux服务器 | 无图形界面，需要开机自动联网 | systemd服务，自动重连 |
| OpenWrt路由器 | 需要稳定的网络连接 | 定时任务，掉线重连 |
| 树莓派/NAS | 家庭服务器，需要持续在线 | 低资源占用，可靠稳定 |
| Docker容器 | 容器内网络认证 | 轻量级，易集成 |

---

## 📊 代码变更统计

### 删除的文件

**VPN相关代码**：
- `server/vpn_server.py`
- `client/vpn_client.py`
- `start_server.py`
- `start_client.py`

**测试文件**（共12个）：
- `test_unauth_network_bind.py`
- `test_vpn_port.py`
- `test_router_wan.py`
- `test_network_comprehensive.py`
- `test_tcp_data_transfer.py`
- `test_port_8888_critical.py`
- `test_multiple_ports.py`
- `test_whitelist_hypothesis.py`
- `test_final_bypass.py`
- `scan_ac_policy.py`
- 等...

**文档**：
- `docs/设备踢下线问题分析.md`
- `docs/AC白名单机制分析.md`
- `docs/nmap扫描结果分析.md`
- `docs/最终结论-项目可行性评估.md`
- 等...

### 保留的核心模块

**认证核心**：
- ✅ `common/drcom_login.py` - Dr.COM认证逻辑
- ✅ `common/wifi_params.py` - WiFi参数获取
- ✅ 相关工具函数

### 新增的文件

**主程序**：
- ✅ `drcom_auth.py` - 统一的命令行工具

**配置和部署**：
- ✅ `config.yaml.example` - 配置文件示例
- ✅ `drcom-auth.service` - systemd服务文件
- ✅ `install.sh` - 自动安装脚本

**文档**：
- ✅ `README.md` - 全新的项目说明
- ✅ `docs/快速开始.md` - 快速入门指南
- ✅ `docs/OpenWrt部署指南.md` - OpenWrt部署说明
- ✅ `项目转型说明.md` - 本文档

---

## 🚀 从v1.x迁移

### 如果您之前使用v1.x（VPN版本）

**好消息**：
- 认证功能完全保留
- 使用更简单（不需要服务器/客户端分离）

**迁移步骤**：

1. **拉取最新代码**
   ```bash
   git pull origin main
   ```

2. **删除旧的VPN配置**
   ```bash
   rm server/config.yaml client/config.yaml
   ```

3. **使用新的配置文件**
   ```bash
   cp config.yaml.example config.yaml
   vi config.yaml  # 填入账号信息
   ```

4. **测试新版本**
   ```bash
   python drcom_auth.py --config config.yaml
   ```

### 核心改进

| 方面 | v1.x (VPN版) | v2.0.0+ (认证版) |
|------|-------------|-----------------|
| **架构** | 服务器/客户端分离 | 单一工具 |
| **部署** | 需要两台设备 | 单设备即可 |
| **配置** | 复杂（需要配置VPN） | 简单（只需账号密码）|
| **维护** | 需要维护VPN连接 | 无需额外维护 |
| **可靠性** | 依赖VPN稳定性 | 直接认证，更可靠 |

---

## 📚 文档更新

### 新文档结构

```
docs/
├── 快速开始.md              # 5分钟入门
├── OpenWrt部署指南.md       # 路由器部署
└── API文档.md               # 开发文档（待创建）

README.md                   # 主文档
CHANGELOG.md                # 更新日志
config.yaml.example         # 配置示例
项目转型说明.md             # 本文档
```

### 推荐阅读顺序

1. **快速开始** → [docs/快速开始.md](docs/快速开始.md)
2. **完整文档** → [README.md](README.md)
3. **OpenWrt用户** → [docs/OpenWrt部署指南.md](docs/OpenWrt部署指南.md)
4. **更新历史** → [CHANGELOG.md](CHANGELOG.md)

---

## 🔮 未来计划

### 短期（1-2个月）

- [ ] Web管理界面
- [ ] 多账号管理
- [ ] 流量统计
- [ ] 更多平台测试

### 中期（3-6个月）

- [ ] Docker镜像发布
- [ ] OpenWrt ipk包
- [ ] Windows图形界面
- [ ] 通知推送（邮件/微信）

### 长期（6个月+）

- [ ] 插件系统
- [ ] 多校园网支持
- [ ] 社区贡献

---

## 🙏 致谢

感谢所有参与测试的用户！虽然VPN方案未能实现，但测试过程让我们：

1. 深入理解了Dr.COM + 锐捷AC的工作机制
2. 发现了认证模块的价值
3. 找到了更实用的应用方向

**这次转型是基于实际测试的理性决策，而不是放弃。**

---

## 📮 反馈

如果您有任何问题或建议，欢迎：

- 💬 提交Issue：[GitHub Issues](https://github.com/yourusername/drcom/issues)
- 📧 发送邮件：your.email@example.com
- 🌟 给项目点个Star

---

**项目新征程，从这里开始！** 🚀

