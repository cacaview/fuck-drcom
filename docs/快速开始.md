# 快速开始

5分钟快速上手Dr.COM自动认证工具。

## 1. 安装

### Linux/macOS

```bash
# 克隆项目
git clone https://github.com/yourusername/drcom.git
cd drcom

# 安装依赖
pip3 install -r requirements.txt

# 或使用安装脚本
chmod +x install.sh
sudo ./install.sh
```

### Windows

```powershell
# 克隆项目
git clone https://github.com/yourusername/drcom.git
cd drcom

# 安装依赖
pip install -r requirements.txt
```

## 2. 基本使用

### 一键认证

```bash
python drcom_auth.py -u 学号 -p 密码
```

### 查询状态

```bash
python drcom_auth.py --status
```

### 主动下线

```bash
python drcom_auth.py --logout
```

## 3. 配置文件（推荐）

创建配置文件避免每次输入账号密码：

```bash
# 复制示例配置
cp config.yaml.example config.yaml

# 编辑配置
vi config.yaml
```

修改以下内容：

```yaml
account:
  username: "你的学号"
  password: "你的密码"
```

使用配置文件：

```bash
python drcom_auth.py --config config.yaml
```

## 4. 自动重连

保持网络连接，掉线自动重连：

```bash
python drcom_auth.py -u 学号 -p 密码 --auto-reconnect
```

或使用配置文件：

```bash
python drcom_auth.py --config config.yaml --auto-reconnect
```

## 5. 后台运行

### Linux - systemd服务

```bash
# 安装服务
sudo cp drcom-auth.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable drcom-auth
sudo systemctl start drcom-auth

# 查看状态
sudo systemctl status drcom-auth

# 查看日志
sudo journalctl -u drcom-auth -f
```

### Linux - nohup

```bash
nohup python drcom_auth.py --config config.yaml --auto-reconnect > drcom.log 2>&1 &
```

### Windows - 任务计划程序

创建批处理文件 `drcom_start.bat`：

```batch
@echo off
cd C:\path\to\drcom
python drcom_auth.py --config config.yaml --auto-reconnect
```

使用任务计划程序设置开机自动运行。

## 6. OpenWrt路由器

```bash
# SSH到路由器
ssh root@192.168.1.1

# 安装Python
opkg update
opkg install python3 python3-pip
pip3 install requests beautifulsoup4 pyyaml

# 上传工具
scp -r drcom/ root@192.168.1.1:/root/

# 测试
python3 drcom_auth.py -u 学号 -p 密码

# 添加定时任务
crontab -e
# 添加：*/5 * * * * /usr/bin/python3 /root/drcom/drcom_auth.py --config /root/drcom/config.yaml
```

详细说明：[OpenWrt部署指南](OpenWrt部署指南.md)

## 7. Docker

创建 `Dockerfile`：

```dockerfile
FROM python:3.9-slim

WORKDIR /app
COPY . /app

RUN pip install --no-cache-dir -r requirements.txt

CMD ["python", "drcom_auth.py", "--config", "config.yaml", "--auto-reconnect"]
```

构建并运行：

```bash
docker build -t drcom-auth .
docker run -d --name drcom --network host drcom-auth
```

## 8. 常见问题

### 认证失败

- 检查用户名密码是否正确
- 确认账号未欠费
- 检查是否已达设备上限

### 无法获取网络参数

```bash
# 手动指定网络接口
python drcom_auth.py --interface eth0 -u 学号 -p 密码
```

### 权限问题（Linux）

```bash
# 使用sudo
sudo python drcom_auth.py -u 学号 -p 密码
```

## 9. 命令行参数速查

```
认证：
  -u, --username      用户名
  -p, --password      密码
  -c, --config        配置文件

操作：
  --login            登录（默认）
  --logout           下线
  --status           查询状态

网络：
  -i, --interface    指定网卡
  --ac-ip            指定AC地址

行为：
  --auto-reconnect   自动重连
  --check-interval   检查间隔（秒）
  --max-retries      最大重试次数

输出：
  -v, --verbose      详细输出
  -q, --quiet        静默模式
```

## 10. 下一步

- 📖 阅读完整文档：[README.md](../README.md)
- 🔧 查看高级配置：[config.yaml.example](../config.yaml.example)
- 🐛 问题反馈：[GitHub Issues](https://github.com/yourusername/drcom/issues)

## 使用场景示例

### 场景1：服务器开机自动联网

```bash
# 设置systemd服务
sudo systemctl enable drcom-auth
```

### 场景2：树莓派NAS自动认证

```bash
# 添加到rc.local
echo "python3 /home/pi/drcom/drcom_auth.py --config /home/pi/drcom/config.yaml" >> /etc/rc.local
```

### 场景3：临时使用

```bash
# 直接运行
python drcom_auth.py -u 学号 -p 密码
```

---

**就这么简单！开始使用吧！** 🚀
